CREATE  PROCEDURE [fpx].[usp_Load_Fact_FuelMessage]
AS
BEGIN
 

    IF OBJECT_ID('[fpx].[Fact_FuelMessage]', 'U') IS NULL
    BEGIN
        SELECT
           [FlightID],
			[ActualSuffix],
			[ActualDepartureDate],
			[CUST_CO_ID],
			[CUST_CO_CD3],
			[ReceivingDelayDays],
			[KPI1],
			[UpliftedFuelCost],
			[ActualFlightDate],
			[ActualRegistration],
			[ActualDestination],
			[ActualAirlineDesignator],
			[ActualFlightNumber],
			[EFF_FUELER_CO_ID],
			[RPT_SUPPL_CD3],
			[RPT_FUELER_CD3],
			[EFF_SUPPL_CD3],
			[EFF_FUELER_CD],
			[UsedForUplift],
			[Destination],
			[FuelTicketNo],
			[FlightDate],
			[RPT_SUPPL_CO_ID],
			[RPT_FUELER_CO_ID],
			[EFF_SUPPL_CO_ID],
			[DeliveryDate],
			[CreationDate],
			[Registration],
			[AirlineDesignator],
			[FlightNumber],
			[Suffix],
			[FuelMessageID],
			[MessageType],
			[MessageSource],
			[DEP_LOC_ID],
			[DEPARTURE] INTO [fpx].[Fact_FuelMessage]
        FROM [LH_ATGIQ].[fpx_raw].[V_ANLF_FuelMessage];
    END
    ELSE
    BEGIN
        TRUNCATE TABLE [fpx].[Fact_FuelMessage];

        INSERT INTO [fpx].[Fact_FuelMessage] (
      [FlightID],
			[ActualSuffix],
			[ActualDepartureDate],
			[CUST_CO_ID],
			[CUST_CO_CD3],
			[ReceivingDelayDays],
			[KPI1],
			[UpliftedFuelCost],
			[ActualFlightDate],
			[ActualRegistration],
			[ActualDestination],
			[ActualAirlineDesignator],
			[ActualFlightNumber],
			[EFF_FUELER_CO_ID],
			[RPT_SUPPL_CD3],
			[RPT_FUELER_CD3],
			[EFF_SUPPL_CD3],
			[EFF_FUELER_CD],
			[UsedForUplift],
			[Destination],
			[FuelTicketNo],
			[FlightDate],
			[RPT_SUPPL_CO_ID],
			[RPT_FUELER_CO_ID],
			[EFF_SUPPL_CO_ID],
			[DeliveryDate],
			[CreationDate],
			[Registration],
			[AirlineDesignator],
			[FlightNumber],
			[Suffix],
			[FuelMessageID],
			[MessageType],
			[MessageSource],
			[DEP_LOC_ID],
			[DEPARTURE]
        )
        SELECT
       [FlightID],
			[ActualSuffix],
			[ActualDepartureDate],
			[CUST_CO_ID],
			[CUST_CO_CD3],
			[ReceivingDelayDays],
			[KPI1],
			[UpliftedFuelCost],
			[ActualFlightDate],
			[ActualRegistration],
			[ActualDestination],
			[ActualAirlineDesignator],
			[ActualFlightNumber],
			[EFF_FUELER_CO_ID],
			[RPT_SUPPL_CD3],
			[RPT_FUELER_CD3],
			[EFF_SUPPL_CD3],
			[EFF_FUELER_CD],
			[UsedForUplift],
			[Destination],
			[FuelTicketNo],
			[FlightDate],
			[RPT_SUPPL_CO_ID],
			[RPT_FUELER_CO_ID],
			[EFF_SUPPL_CO_ID],
			[DeliveryDate],
			[CreationDate],
			[Registration],
			[AirlineDesignator],
			[FlightNumber],
			[Suffix],
			[FuelMessageID],
			[MessageType],
			[MessageSource],
			[DEP_LOC_ID],
			[DEPARTURE]
        FROM [LH_ATGIQ].[fpx_raw].[V_ANLF_FuelMessage];
    END
END